import{j as e,r as g}from"./index-6d29d96c.js";import{P as i,k as w,Q as m,s as y}from"./index-469e6d33.js";const j=t=>{let n=0;return t.forEach(o=>{n+=o.price*o.quantity}),n.toFixed(2)},v="_form_wrapper_vg500_1",q="_form_vg500_1",C="_label_vg500_16",D="_input_part_vg500_21",P="_input_vg500_21",c={form_wrapper:v,form:q,label:C,input_part:D,input:P},x=({formData:t})=>{const n=o=>{const{name:d,value:p}=o.target;t.set(d,p)};return e.jsx("div",{className:c.form_wrapper,children:e.jsxs("form",{className:c.form,children:[e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Name"}),e.jsx("input",{className:c.input,type:"text",name:"name",onChange:n,placeholder:"John"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Email"}),e.jsx("input",{className:c.input,type:"email",name:"email",onChange:n,placeholder:"example@mail.com"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Address"}),e.jsx("input",{className:c.input,type:"text",name:"address",onChange:n,placeholder:"Antonovycha str.75"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Phone"}),e.jsx("input",{className:c.input,type:"text",name:"phone",onChange:n,placeholder:"+380501111111"})]})]})})};x.propTypes={formData:i.object.isRequired};const k="_card_1a1zj_1",S="_image_wrapper_1a1zj_6",R="_image_1a1zj_6",O="_title_1a1zj_21",z="_price_1a1zj_27",I="_addButton_1a1zj_34",B="_button_wrapper_1a1zj_47",E="_button_increment_1a1zj_53",T="_button_decrement_1a1zj_54",J="_count_1a1zj_78",l={card:k,image_wrapper:S,image:R,title:O,price:z,addButton:I,button_wrapper:B,button_increment:E,button_decrement:T,count:J},f=({id:t,imageUrl:n,title:o,price:d,quantity:p,handleButtonClick:r,handleDecrement:s,handleIncrement:a})=>e.jsxs("div",{className:l.card,children:[e.jsx("div",{className:l.image_wrapper,children:e.jsx("img",{className:l.image,width:200,height:80,src:n,alt:"meal"})}),e.jsxs("div",{children:[e.jsx("p",{className:l.title,children:o}),e.jsxs("p",{className:l.price,children:["Price: ",d,"$"]})]}),e.jsxs("div",{className:l.button_wrapper,children:[e.jsx("button",{className:l.button_decrement,onClick:s,children:"-"}),e.jsx("span",{className:l.count,children:p}),e.jsx("button",{className:l.button_increment,onClick:a,children:"+"})]}),e.jsx("button",{className:l.addButton,type:"button",onClick:()=>r(t),children:"Remove"})]});f.propTypes={id:i.string.isRequired,title:i.string.isRequired,imageUrl:i.string.isRequired,price:i.number.isRequired,quantity:i.number.isRequired,handleButtonClick:i.func.isRequired,handleIncrement:i.func.isRequired,handleDecrement:i.func.isRequired};const $="_wrapper_g1khf_1",F="_order_list_g1khf_11",A="_order_item_g1khf_24",L="_total_g1khf_38",Y="_text_g1khf_45",_={wrapper:$,order_list:F,order_item:A,total:L,text:Y},b=({orderedDish:t,handleButtonClick:n,setOrderedDish:o})=>{const d=r=>{const s=t.map(a=>a.id===r?{...a,quantity:a.quantity+1}:a);o(s),localStorage.setItem("dishes",JSON.stringify(s))},p=r=>{const s=t.map(a=>a.id===r&&a.quantity>1?{...a,quantity:a.quantity-1}:a);o(s),localStorage.setItem("dishes",JSON.stringify(s))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:_.wrapper,children:[e.jsxs("p",{className:_.total,children:["Total Price: ",j(t),"$"]}),e.jsx("p",{children:"Your cart is empty"}),t.length>0?e.jsx("ul",{className:_.order_list,children:t.map(({id:r,imageUrl:s,title:a,price:h,quantity:N})=>e.jsx("li",{className:_.order_item,children:e.jsx(f,{id:r,imageUrl:s,title:a,price:h,quantity:N,handleIncrement:()=>d(r),handleDecrement:()=>p(r),handleButtonClick:n})},r))}):e.jsx("img",{src:"../../../src/images/cart.png",alt:"cart is empty",width:600})]})})};b.propTypes={orderedDish:i.array.isRequired,handleButtonClick:i.func,setOrderedDish:i.func};const Q="_page_container_1t5oo_1",U="_content_wrapper_1t5oo_7",V="_cartPage_title_1t5oo_11",G="_submit_button_1t5oo_16",u={page_container:Q,content_wrapper:U,cartPage_title:V,submit_button:G},M=()=>{const t=new FormData,[n,o]=g.useState([]);console.log(n.length),g.useEffect(()=>{const r=JSON.parse(localStorage.getItem("dishes"))||[];o(r);const s=a=>{if(a.key==="dishes"){const h=JSON.parse(a.newValue)||[];o(h)}};return window.addEventListener("storage",s),()=>{window.removeEventListener("storage",s)}},[]);const d=r=>{const s=n.filter(a=>a.id!==r);o(s),localStorage.setItem("dishes",JSON.stringify(s))},p=async r=>{if(r.preventDefault(),t.get("name")===null||t.get("address")===null||t.get("email")===null||t.get("phone")===null){m.info("Please fill all fields and choose dishes");return}if(n.length===0){m.info("Please choose dishes");return}try{const s={name:t.get("name"),email:t.get("email"),address:t.get("address"),phone:t.get("phone"),dishes:n,totalPrice:j(n)};await y(s).then(()=>{m.info("your order was successful")})}catch(s){m.warn("Oops! Something went wrong"),console.log(s.message)}localStorage.removeItem("dishes"),o([])};return e.jsxs("main",{className:u.page_container,children:[e.jsx("h2",{className:u.cartPage_title,children:"Your cart"}),e.jsx("button",{className:u.submit_button,onClick:r=>p(r),children:"Place an order"}),e.jsxs("div",{className:u.content_wrapper,children:[e.jsx(x,{formData:t}),e.jsx(b,{orderedDish:n,handleButtonClick:d,setOrderedDish:o})]}),e.jsx(w,{autoClose:2e3})]})};export{M as default};
