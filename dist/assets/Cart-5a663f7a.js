import{j as e,r as g}from"./index-c0ba0c60.js";import{P as i,k as w,Q as m,s as y}from"./index-559cf5cb.js";const j=t=>{let r=0;return t.forEach(o=>{r+=o.price*o.quantity}),r.toFixed(2)},v="_form_wrapper_vg500_1",q="_form_vg500_1",C="_label_vg500_16",D="_input_part_vg500_21",S="_input_vg500_21",c={form_wrapper:v,form:q,label:C,input_part:D,input:S},x=({formData:t})=>{const r=o=>{const{name:d,value:p}=o.target;t.set(d,p)};return e.jsx("div",{className:c.form_wrapper,children:e.jsxs("form",{className:c.form,children:[e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Name"}),e.jsx("input",{className:c.input,type:"text",name:"name",onChange:r,placeholder:"John"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Email"}),e.jsx("input",{className:c.input,type:"email",name:"email",onChange:r,placeholder:"example@mail.com"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Address"}),e.jsx("input",{className:c.input,type:"text",name:"address",onChange:r,placeholder:"Antonovycha str.75"})]}),e.jsxs("label",{className:c.label,children:[e.jsx("span",{className:c.input_part,children:"Phone"}),e.jsx("input",{className:c.input,type:"text",name:"phone",onChange:r,placeholder:"+380501111111"})]})]})})};x.propTypes={formData:i.object.isRequired};const k="_card_1a1zj_1",P="_image_wrapper_1a1zj_6",R="_image_1a1zj_6",O="_title_1a1zj_21",z="_price_1a1zj_27",I="_addButton_1a1zj_34",B="_button_wrapper_1a1zj_47",E="_button_increment_1a1zj_53",T="_button_decrement_1a1zj_54",J="_count_1a1zj_78",l={card:k,image_wrapper:P,image:R,title:O,price:z,addButton:I,button_wrapper:B,button_increment:E,button_decrement:T,count:J},f=({id:t,imageUrl:r,title:o,price:d,quantity:p,handleButtonClick:n,handleDecrement:a,handleIncrement:s})=>e.jsxs("div",{className:l.card,children:[e.jsx("div",{className:l.image_wrapper,children:e.jsx("img",{className:l.image,width:200,height:80,src:r,alt:"meal"})}),e.jsxs("div",{children:[e.jsx("p",{className:l.title,children:o}),e.jsxs("p",{className:l.price,children:["Price: ",d,"$"]})]}),e.jsxs("div",{className:l.button_wrapper,children:[e.jsx("button",{className:l.button_decrement,onClick:a,children:"-"}),e.jsx("span",{className:l.count,children:p}),e.jsx("button",{className:l.button_increment,onClick:s,children:"+"})]}),e.jsx("button",{className:l.addButton,type:"button",onClick:()=>n(t),children:"Remove"})]});f.propTypes={id:i.string.isRequired,title:i.string.isRequired,imageUrl:i.string.isRequired,price:i.number.isRequired,quantity:i.number.isRequired,handleButtonClick:i.func.isRequired,handleIncrement:i.func.isRequired,handleDecrement:i.func.isRequired};const $="_wrapper_g1khf_1",F="_order_list_g1khf_11",A="_order_item_g1khf_24",L="_total_g1khf_38",Q="_text_g1khf_45",_={wrapper:$,order_list:F,order_item:A,total:L,text:Q},b=({orderedDish:t,handleButtonClick:r,setOrderedDish:o})=>{const d=n=>{const a=t.map(s=>s.id===n?{...s,quantity:s.quantity+1}:s);o(a),localStorage.setItem("dishes",JSON.stringify(a))},p=n=>{const a=t.map(s=>s.id===n&&s.quantity>1?{...s,quantity:s.quantity-1}:s);o(a),localStorage.setItem("dishes",JSON.stringify(a))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:_.wrapper,children:[e.jsxs("p",{className:_.total,children:["Total Price: ",j(t),"$"]}),t.length>0?e.jsx("ul",{className:_.order_list,children:t.map(({id:n,imageUrl:a,title:s,price:u,quantity:N})=>e.jsx("li",{className:_.order_item,children:e.jsx(f,{id:n,imageUrl:a,title:s,price:u,quantity:N,handleIncrement:()=>d(n),handleDecrement:()=>p(n),handleButtonClick:r})},n))}):e.jsx("img",{src:"https://i.postimg.cc/c4fSdRz9/25518797c3883faa8c2b68d427367eba.png",alt:"cart is empty",width:600})]})})};b.propTypes={orderedDish:i.array.isRequired,handleButtonClick:i.func,setOrderedDish:i.func};const U="_page_container_1t5oo_1",V="_content_wrapper_1t5oo_7",G="_cartPage_title_1t5oo_11",H="_submit_button_1t5oo_16",h={page_container:U,content_wrapper:V,cartPage_title:G,submit_button:H},W=()=>{const t=new FormData,[r,o]=g.useState([]);g.useEffect(()=>{const n=JSON.parse(localStorage.getItem("dishes"))||[];o(n);const a=s=>{if(s.key==="dishes"){const u=JSON.parse(s.newValue)||[];o(u)}};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}},[]);const d=n=>{const a=r.filter(s=>s.id!==n);o(a),localStorage.setItem("dishes",JSON.stringify(a))},p=async n=>{if(n.preventDefault(),t.get("name")===null||t.get("address")===null||t.get("email")===null||t.get("phone")===null){m.info("Please fill all fields and choose dishes");return}if(r.length===0){m.info("Please choose dishes");return}try{const a={name:t.get("name"),email:t.get("email"),address:t.get("address"),phone:t.get("phone"),dishes:r,totalPrice:j(r)};await y(a).then(()=>{m.info("your order was successful")})}catch(a){m.warn("Oops! Something went wrong"),console.log(a.message)}localStorage.removeItem("dishes"),o([])};return e.jsxs("main",{className:h.page_container,children:[e.jsx("button",{className:h.submit_button,onClick:n=>p(n),children:"Place an order"}),e.jsxs("div",{className:h.content_wrapper,children:[e.jsx(x,{formData:t}),e.jsx(b,{orderedDish:r,handleButtonClick:d,setOrderedDish:o})]}),e.jsx(w,{autoClose:2e3})]})};export{W as default};
